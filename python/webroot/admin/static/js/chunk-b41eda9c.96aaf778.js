(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b41eda9c"],{b491:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n}));var s=a("b775");function r(e){return Object(s["a"])({url:"/api/set_config.py",method:"get",params:e})}function i(e){return Object(s["a"])({url:"/api/set_config.py",method:"post",params:e})}function n(e){return Object(s["a"])({url:"/api/system_update.py",method:"get",params:e})}},d370:function(e,t,a){},d8df:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"当前版本"}},[a("span",[e._v(e._s(e.version))]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",loading:e.check_loading,disabled:e.check_disabled},on:{click:e.isupdate}},[e._v("检查更新")]),e._v(" "),a("span",{class:{yes_upgrade:e.is_updata,no_upgrade:!e.is_updata}},[e._v(e._s(e.check_tishi))])],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[e.is_updata?a("el-button",{attrs:{type:"success",loading:e.update_loading,disabled:e.update_disabled},on:{click:e.startupdate}},[e._v("立即升级")]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[e.is_percent?a("el-progress",{attrs:{percentage:e.update_progress,status:"success"}}):e._e()],1)],1)],1)},r=[],i=(a("a481"),a("b491")),n={data:function(){return{version:"0.0.1",is_updata:!1,is_percent:!1,check_loading:!1,check_disabled:!1,update_loading:!1,update_disabled:!1,update_progress:0,check_tishi:""}},created:function(){this.fetchData()},methods:{get_remotever:function(){var e=this,t=this;Object(i["c"])({op:"remotever"}).then((function(a){var s=a.data;"0000"!==s.error?setTimeout((function(){t.get_remotever()}),1e3):(e.check_loading=!1,e.check_disabled=!1,s.upgrade>0?e.is_updata=!0:e.is_updata=!1,e.check_tishi=a.message)}))},get_progress:function(){var e=this,t=this;Object(i["c"])({op:"updatestate"}).then((function(a){var s=a.data;if("0000"!==s.error)setTimeout((function(){t.get_progress()}),1e3);else{var r=parseInt(s.progress);if(e.update_progress>=0&&e.update_progress<90&&(e.update_progress=e.update_progress+1),r>0&&r>e.update_progress&&(e.update_progress=r),!(r<100))return void e.$alert("恭喜您，系统升级成功！","自美系统",{confirmButtonText:"确定",callback:function(t){e.$router.replace("user/logout"),e.$router.replace("/login")}});setTimeout((function(){t.get_progress()}),1e3)}}))},fetchData:function(){var e=this;this.listLoading=!0,Object(i["c"])({op:"localver"}).then((function(t){var a=t.data;e.version=a.version,e.listLoading=!1}))},isupdate:function(){var e=this;this.check_loading=!0,this.check_disabled=!0,this.is_updata=!1,Object(i["c"])({op:"isupdate"}).then((function(t){var a=t.data;"0000"===a.error&&(e.check_tishi="正在获取远程最新版本，请稍候……",setTimeout((function(){e.get_remotever()}),1e3))}))},startupdate:function(){var e=this;this.update_loading=!0,this.check_disabled=!0,this.update_disabled=!0,this.is_percent=!0,Object(i["c"])({op:"startupdate"}).then((function(t){var a=t.data;"0000"===a.error&&e.get_progress()}))}}},o=n,c=(a("e28c"),a("2877")),u=Object(c["a"])(o,s,r,!1,null,"9ecf3eba",null);t["default"]=u.exports},e28c:function(e,t,a){"use strict";var s=a("d370"),r=a.n(s);r.a}}]);