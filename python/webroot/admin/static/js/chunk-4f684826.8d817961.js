(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f684826"],{"0123":function(t,e,a){"use strict";var s=a("a053"),i=a.n(s);i.a},a053:function(t,e,a){},b491:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return r}));var s=a("b775");function i(t){return Object(s["a"])({url:"/api/set_config.py",method:"get",params:t})}function r(t){return Object(s["a"])({url:"/api/system_update.py",method:"get",params:t})}},d8df:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"当前版本"}},[a("span",[t._v(t._s(t.config.version))]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",loading:t.check_loading,disabled:t.check_disabled},on:{click:t.isupdate}},[t._v("检查更新")]),t._v(" "),a("span",[t._v(t._s(t.check_tishi))])],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[t.is_updata?a("el-button",{attrs:{type:"success",loading:t.update_loading,disabled:t.update_disabled},on:{click:t.startupdate}},[t._v("立即升级")]):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[t.is_percent?a("el-progress",{attrs:{percentage:t.update_progress,status:"success"}}):t._e()],1)],1)],1)},i=[],r=(a("a481"),a("b491")),n={data:function(){return{config:[],is_updata:!1,is_percent:!1,check_loading:!1,check_disabled:!1,update_loading:!1,update_disabled:!1,update_progress:0,check_tishi:""}},created:function(){this.fetchData()},methods:{get_remotever:function(){var t=this,e=this;Object(r["b"])({op:"remotever"}).then((function(a){var s=a.data;"0000"!==s.error?setTimeout((function(){e.get_remotever()}),1e3):(t.check_loading=!1,t.check_disabled=!1,s.upgrade>0?t.is_updata=!0:t.is_updata=!1,t.check_tishi=a.message)}))},get_progress:function(){var t=this,e=this;Object(r["b"])({op:"updatestate"}).then((function(a){var s=a.data;if("0000"!==s.error)setTimeout((function(){e.get_progress()}),1e3);else{var i=parseInt(s.progress);if(t.update_progress>=0&&t.update_progress<90&&(t.update_progress=t.update_progress+1),i>0&&i>t.update_progress&&(t.update_progress=i),!(i<100))return void t.$alert("恭喜您，系统升级成功！","自美系统",{confirmButtonText:"确定",callback:function(e){t.$router.replace("user/logout"),t.$router.replace("/login")}});setTimeout((function(){e.get_progress()}),1e3)}}))},fetchData:function(){var t=this;this.listLoading=!0,Object(r["a"])({op:"getconfig"}).then((function(e){var a=e.data;t.config=a.config,t.listLoading=!1}))},isupdate:function(){var t=this;this.check_loading=!0,this.check_disabled=!0,this.is_updata=!1,Object(r["b"])({op:"isupdate"}).then((function(e){var a=e.data;"0000"===a.error&&(t.check_tishi="正在获取远程最新版本，这里可能需要2-3分钟，请稍候……",setTimeout((function(){t.get_remotever()}),1e3))}))},startupdate:function(){var t=this;this.update_loading=!0,this.check_disabled=!0,this.update_disabled=!0,this.is_percent=!0,Object(r["b"])({op:"startupdate"}).then((function(e){var a=e.data;"0000"===a.error&&t.get_progress()}))}}},o=n,c=(a("0123"),a("2877")),u=Object(c["a"])(o,s,i,!1,null,"04712208",null);e["default"]=u.exports}}]);